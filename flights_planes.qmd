---
title: "'nycflights13' ë³´ê³ ì„œ"
title-slide-attributes: 
  data-background-image: images/ua_dep.png
  data-background-size: cover
  data-background-opacity: "0.5"  # ë°°ê²½ íˆ¬ëª…ë„ ì¡°ì ˆ
  data-font-size: 48px  # ğŸ”¥ ê¸°ë³¸ ê¸€ì í¬ê¸° ì¡°ì ˆ (ì œëª©, ë¶€ì œëª©, ì €ì í¬í•¨)
author: "Team F5 : ì •ì˜ì£¼, í•œì§€ìˆ˜, ì‹ íƒœì„ "
subtitle: "UA í•­ê³µì˜ ì œì¡°ì‚¬ë³„ ì¶œë°œ ì§€ì—° ë¶„ì„"
format:
  revealjs:
    footer: "Â© 2025 Team F5"
    logo: "images/logo.png"
    slide-number: true
    theme: night  # ë‚´ì¥ í…Œë§ˆ ì ìš©
    html: 
      code-fold: true  # (ì„ íƒ) ì½”ë“œ ì ‘ê¸° ê¸°ëŠ¥ ì¶”ê°€
execute:
  echo: true  # ê¸°ë³¸ì ìœ¼ë¡œ ì½”ë“œì™€ ê²°ê³¼ ëª¨ë‘ í‘œì‹œ
  warning: false  # (ì„ íƒ) ê²½ê³  ë©”ì‹œì§€ ìˆ¨ê¸°ê¸°
css: styles.css  # ğŸ”¥ CSS íŒŒì¼ ì ìš©
---

```{python}
#| echo : false 
import pandas as pd
import numpy as np
import seaborn as sns
import matplotlib.pyplot as plt
from nycflights13 import flights, planes

```

## 1. ìš´í•­ ì§€ì—° ë¶„ì„ ë°°ê²½ {.text-center}

::: {.callout-note appearance="simple"}

### âœˆï¸ UA í•­ê³µì‚¬ í•­ê³µê¸° ì§€ì—° ë¶„ì„
- **ì–´ë–¤ ì œì¡°ì‚¬ì˜ í•­ê³µê¸°ê°€ ì§€ì—°ì„ ìì£¼ ìœ ë°œí•˜ëŠ”ê°€?**  
- **ìš´í•­ íš¨ìœ¨ì„±ì„ í–¥ìƒì‹œí‚¤ê¸° ìœ„í•œ ë°©ì•ˆì€ ë¬´ì—‡ì¸ê°€?**
:::

![](./images/catoon.png){width=800 height=400}

## 2.1 ë°ì´í„° ì •ë³´

::: {.column width="50%" style="margin-top:100px;"}
```{python}
flights.info()
```
:::
::: {.column width="50%" style="margin-top:100px;"}

```{python}
planes.info()
```
:::

## 2.2 ë°ì´í„° ì „ì²˜ë¦¬

- ë‘ ë°ì´í„°ë¥¼ tailnum ê¸°ì¤€ìœ¼ë¡œ ë³‘í•©í•˜ì—¬ ê¸°ì²´ë³„ ì œì¡°ì‚¬ ì •ë³´ë¥¼ ê²°í•©
```{python}
# tailnumì„ keyë¡œ merge í•˜ê¸° 
df = pd.merge(flights, planes, on = 'tailnum', how='left')
print("ë³‘í•©ëœ ë°ì´í„° :", len(df))
```

```{python}
#| echo : false 

# í•­ê³µì‚¬ë³„ ìš´í•­ í¸
flight = flights.groupby('carrier')['flight'].nunique().reset_index()
flight_sorted = flight.sort_values(by='flight', ascending=False)

# ì‹œê°í™”
plt.figure(figsize=(10, 2))
plt.bar(flight_sorted['carrier'], flight_sorted['flight'], color='skyblue')

plt.xlabel("Airline", fontsize=15, fontweight='bold')
plt.ylabel("Number of Flights", fontsize=15, fontweight='bold')
plt.title("Number of Flights by Airline", fontsize=20, fontweight='bold')
plt.xticks(rotation=45)
plt.show()
```

- UA í•­ê³µì‚¬(ìš°ë¦¬ íšŒì‚¬: ìš´í–‰ëŸ‰ 1ìœ„) ë°ì´í„°ë§Œ ê°€ì ¸ì˜¤ê¸°
```{python}
df  = df[df['carrier']=='UA']
df_len = len(df)
print("UA í•­ê³µì‚¬ì˜ ìš´í–‰ëŸ‰ :", df_len)
```

## 2.3 ë‚ ì§œ ë° ì‹œê°„ ë°ì´í„° ì¶”ê°€
- ì—°, ì›”, ì¼, ì‹œ, ë¶„ ë°ì´í„°ë¥¼ ì¡°í•©í•´ date_time ìƒì„±
```{python}
df['date_time'] = pd.to_datetime(df['year_x'].astype(str) + '-' + df['month'].astype(str) + '-' + df['day'].astype(str) + ' ' + df['hour'].astype(str) + ':' + df['minute'].astype(str))
```

- 2013ë…„ 1ì›”~6ì›”(ìƒë°˜ê¸°) ë°ì´í„°ë¥¼ í•„í„°ë§
```{python}
df_fh =df
#df_fh = df[(df['date_time'] >= '2013-01-01') & (df['date_time'] <= '2013-06-30')]
#first_half = len(df_fh)
#print("f {df_len}=>{fisrt_half}")
```

- ë¹ ë¥¸ ì´ë¥™ì€ ì§€ì—° ì›ì¸ì´ ì•„ë‹ˆë¯€ë¡œ 0ìœ¼ë¡œ ë³€ê²½
```{python}

#0ë³´ë‹¤ ì‘ìœ¼ë©´ 0ì´ë¼ê³  í•˜ê¸° 
df_fh['dep_delay'] = df_fh['dep_delay'].apply(lambda x: 0 if x < 0 else x)

zero_df_fh = len(df_fh)
# ë³€í™˜ í›„ ë°ì´í„° í¬ê¸° ì¶œë ¥
print(zero_df_fh)
```

## 2.4 ì´ìƒì¹˜ ì œê±°

- ì´ìƒì¹˜ ì œê±°ë¥¼ ìœ„í•œ IQR(Interquartile Range) ê³„ì‚°

```{python}
Q1 = df_fh['dep_delay'].quantile(0.25)
Q3 = df_fh['dep_delay'].quantile(0.75)
IQR = Q3 - Q1


lower_bound = Q1 - 1.5 * IQR
upper_bound = Q3 + 1.5 * IQR

df_fh = df_fh[(df_fh['dep_delay'] >= lower_bound) & (df_fh['dep_delay'] <= upper_bound)]
iqr_del_df = len(df_fh)

print(Q1, Q3)
print("f {zero_df_fh} => {iqr_del_df}")
```

## 3.1 ì œì¡°ì‚¬ë³„ í‰ê·  ë° ì¤‘ì•™ê°’ ì§€ì—° ì‹œê°„ ë¶„ì„  

::: {.callout-note appearance="simple"}
### â³ ì œì¡°ì‚¬ë³„ í‰ê·  ì§€ì—° ì‹œê°„ & ì¤‘ì•™ê°’ ì§€ì—° ì‹œê°„ ë¹„êµ  
- **íŠ¹ì • ì œì¡°ì‚¬ì˜ í•­ê³µê¸°ê°€ í‰ê· ì ìœ¼ë¡œ ë” ì˜¤ë«ë™ì•ˆ ì§€ì—°ë˜ëŠ”ê°€?**  
- **í‰ê· (Mean)ê³¼ ì¤‘ì•™ê°’(Median)ì„ ë¹„êµí•˜ì—¬ ì´ìƒì¹˜(outlier)ì˜ ì˜í–¥ì„ í™•ì¸**  
:::

::: {.cell}
```{python}
#| echo: false
#| fig-align: "center"

# 0ì„ ì œì™¸í•œ ë°ì´í„° ì‚¬ìš©
filtered_df = df_fh[df_fh['dep_delay'] > 0]

# ì œì¡°ì‚¬ë³„ í‰ê·  ë° ì¤‘ì•™ê°’ ê³„ì‚° ë° ì •ë ¬
manufacturer_stats = filtered_df.groupby('manufacturer')['dep_delay'].agg(['mean', 'median']).sort_values(by='mean', ascending=False)

# ë³´ì‰(Boeing)ì„ ê°€ì¥ ë¨¼ì € ì •ë ¬
if 'BOEING' in manufacturer_stats.index:
    manufacturer_stats = manufacturer_stats.reindex(['BOEING'] + [m for m in manufacturer_stats.index if m != 'BOEING'])

# ì „ì²´ ì œì¡°ì‚¬ì˜ í‰ê·  ë° ì¤‘ì•™ê°’ í‰ê·  ê³„ì‚°
mean_avg = manufacturer_stats['mean'].mean()
median_avg = manufacturer_stats['median'].mean()

# ì‹œê°í™”
fig, axes = plt.subplots(1, 2, figsize=(12, 4.5))

# í‰ê· ê°’ ê·¸ë˜í”„
sns.barplot(x=manufacturer_stats.index, y=manufacturer_stats['mean'], ax=axes[0], palette='pastel')
axes[0].axhline(mean_avg, color='red', linestyle='--', label=f'Mean Avg: {mean_avg:.1f}')
axes[0].set_title('Aircraft Manufacturer Delay (Mean)')
axes[0].set_ylabel('Average Delay (minutes)')
axes[0].set_xticklabels(axes[0].get_xticklabels(), rotation=45, ha='right')
axes[0].legend()

# ì¤‘ì•™ê°’ ê·¸ë˜í”„
sns.barplot(x=manufacturer_stats.index, y=manufacturer_stats['median'], ax=axes[1], palette='pastel')
axes[1].axhline(median_avg, color='blue', linestyle='--', label=f'Median Avg: {median_avg:.1f}')
axes[1].set_title('Aircraft Manufacturer Delay (Median)')
axes[1].set_ylabel('Median Delay (minutes)')
axes[1].set_xticklabels(axes[1].get_xticklabels(), rotation=45, ha='right')
axes[1].legend()

plt.tight_layout()
plt.show()
```
:::


## 3.2  ì œì¡°ì‚¬ ë°ì´í„° ì²˜ë¦¬

::: {.callout-note appearance="simple"}
### UA í•­ê³µì‚¬ê°€ ìš´í–‰í•˜ëŠ” ë¹„í–‰ê¸°ì˜ ì œì¡°ì‚¬ì˜ ë¹„ìœ¨
:::

```{python}
#| echo: false
#| fig-align: "center"

manufacturer_counts = df_fh['manufacturer'].value_counts()

# ì œì¡°ì‚¬ ì´ë¦„ê³¼ ìš´í•­ íšŸìˆ˜ë¥¼ í•¨ê»˜ í‘œì‹œ
labels = [f"{manufacturer} ({count})" for manufacturer, count in zip(manufacturer_counts.index, manufacturer_counts.values)]


plt.figure(figsize=(5, 5))
plt.pie(manufacturer_counts, labels=labels, autopct='%1.1f%%', startangle=140, colors=sns.color_palette('pastel'))
plt.title('Aircraft Manufacturer Distribution for Our Airline')
plt.show()
```

## 3.3 ì œì¡°ì‚¬ë³„ ì§€ì—° ë°œìƒ ë¹ˆë„ ë¶„ì„  

::: {.callout-note appearance="simple"}
### ğŸš€ ì œì¡°ì‚¬ë³„ ì§€ì—° ë°œìƒ íšŸìˆ˜ ë° ë¹„ìœ¨  
- **ì–´ë–¤ ì œì¡°ì‚¬ì˜ í•­ê³µê¸°ê°€ ê°€ì¥ ë§ì´ ì§€ì—°ë˜ëŠ”ê°€?**  
- **ì „ì²´ ìš´í•­ ëŒ€ë¹„ ì§€ì—° ë¹„ìœ¨ì€ ì œì¡°ì‚¬ë³„ë¡œ ì°¨ì´ê°€ ìˆëŠ”ê°€?**  
:::

```{python}
#| echo: false
#| fig-align: "center"

import matplotlib.pyplot as plt
import seaborn as sns

# ì§€ì—° ë°œìƒ íšŸìˆ˜ ê³„ì‚° (dep_delay > 0 ì¸ ê²½ìš°ë§Œ)
delay_counts = df_fh[df_fh['dep_delay'] > 0].groupby('manufacturer')['dep_delay'].count()

# ì „ì²´ ìš´í•­ ëŒ€ë¹„ ì§€ì—° ë¹„ìœ¨ ê³„ì‚°
total_flights = df_fh['manufacturer'].value_counts()
delay_rate = (delay_counts / total_flights).fillna(0) * 100  # í¼ì„¼íŠ¸ ë³€í™˜

# ë°ì´í„° ì •ë ¬
delay_df = (
    pd.DataFrame({'Delay Count': delay_counts, 'Delay Rate (%)': delay_rate})
    .sort_values(by="Delay Count", ascending=False)
)

# ì‹œê°í™”
fig, ax1 = plt.subplots(figsize=(10, 3.7))

sns.barplot(x=delay_df.index, y=delay_df["Delay Count"], palette="pastel", ax=ax1)
ax1.set_ylabel("Number of Delays", fontsize=12)
ax1.set_xlabel("Manufacturer", fontsize=12)
ax1.set_title("Number of Delays by Manufacturer", fontsize=14)
ax1.tick_params(axis="x", rotation=45)

# ì§€ì—° ë¹„ìœ¨(%) ì¶”ê°€ (ë³´ì¡° ì¶•)
ax2 = ax1.twinx()
sns.lineplot(x=delay_df.index, y=delay_df["Delay Rate (%)"], marker="o", color="red", ax=ax2)
ax2.set_ylabel("Delay Rate (%)", fontsize=12)
ax2.grid(False)

plt.show()

```


## 4. ê²°ë¡  ì •ë¦¬


```{python}

#|echo : false

import matplotlib.pyplot as plt
import seaborn as sns
import pandas as pd

# ë‹¤í¬ê·¸ë ˆì´ HEX ì½”ë“œ ì„¤ì •
dark_gray = '#A9A9A9'

# ì‹œê°í™”: 4ê°œì˜ ì„œë¸Œí”Œë¡¯ ìƒì„±
fig, axes = plt.subplots(2, 2, figsize=(14, 6.5))

# (1) ì œì¡°ì‚¬ë³„ ì§€ì—° í‰ê·  ê·¸ë˜í”„
sns.barplot(x=manufacturer_stats.index, y=manufacturer_stats['mean'], ax=axes[0, 0], 
            palette=['red' if x == 'BOEING' else ('gray' if i == 1 else dark_gray) for i, x in enumerate(manufacturer_stats.index)])
axes[0, 0].axhline(mean_avg, color='black', linestyle='--', label=f'Mean Avg: {mean_avg:.1f}')
axes[0, 0].set_title('Aircraft Manufacturer Delay (Mean)')
axes[0, 0].set_ylabel('Average Delay (minutes)')
axes[0, 0].legend()

# (2) ì œì¡°ì‚¬ë³„ ì§€ì—° ì¤‘ì•™ê°’ ê·¸ë˜í”„
sns.barplot(x=manufacturer_stats.index, y=manufacturer_stats['median'], ax=axes[0, 1], 
            palette=['red' if x == 'BOEING' else ('gray' if i == 1 else dark_gray) for i, x in enumerate(manufacturer_stats.index)])
axes[0, 1].axhline(median_avg, color='black', linestyle='--', label=f'Median Avg: {median_avg:.1f}')
axes[0, 1].set_title('Aircraft Manufacturer Delay (Median)')
axes[0, 1].set_ylabel('Median Delay (minutes)')
axes[0, 1].legend()

# (3) ì œì¡°ì‚¬ë³„ ìš´í•­ íšŸìˆ˜ íŒŒì´ì°¨íŠ¸
axes[1, 0].pie(manufacturer_counts, labels=labels, autopct='%1.1f%%', startangle=140, 
               colors=['red' if i == 0 else ('gray' if i == 1 else dark_gray) for i in range(len(manufacturer_counts))])
axes[1, 0].set_title('Aircraft Manufacturer Distribution for Our Airline')

# (4) ì§€ì—° ë°œìƒ íšŸìˆ˜ ë° ë¹„ìœ¨ ê·¸ë˜í”„
sns.barplot(x=delay_df.index, y=delay_df["Delay Count"], ax=axes[1, 1], 
            palette=['red' if x == 'BOEING' else ('gray' if i == 1 else dark_gray) for i, x in enumerate(delay_df.index)])
axes[1, 1].set_ylabel("Number of Delays")
axes[1, 1].set_title("Number of Delays by Manufacturer")

# ì§€ì—° ë¹„ìœ¨(%) ì¶”ê°€ (ë³´ì¡° ì¶•)
ax2 = axes[1, 1].twinx()
sns.lineplot(x=delay_df.index, y=delay_df["Delay Rate (%)"], marker="o", color="black", ax=ax2)
ax2.set_ylabel("Delay Rate (%)")
ax2.grid(False)

plt.tight_layout()
plt.show()

```
# 
1. ì œì¡°ì‚¬ë³„ í‰ê·  ì§€ì—° ì‹œê°„, ì¤‘ì•™ê°’ì€ ë¹„ìŠ·í•˜ë‹¤.
2. ìš°ë¦¬ í•­ê³µì‚¬ê°€ ìš´í–‰í•˜ëŠ” ë¹„í–‰ê¸°ì˜ ì œì¡°ì‚¬ ë¹„ìœ¨ì€ ë³´ì‰ì´ 72.2ë¡œ ì••ë„ì ì´ë‹¤. 
3. ë˜ ì œì¡°ì‚¬ë³„ ì§€ì—° ë°œìƒ ë¹ˆë„ë¥¼ ë¶„ì„í–ˆì„ ë•Œ ë³´ì‰ì‚¬ì˜ ë¹„í–‰ê¸°ê°€ 42%ë¡œ ê°€ì¥ ë†’ì€ ë¹„ìœ¨ì„ ë³´ì—¬ì¤€ë‹¤. 
4. ë”°ë¼ì„œ ìš°ë¦¬ëŠ” í•œì •ëœ ìì›ìœ¼ë¡œ íš¨ìœ¨ì ì¸ í•­ê³µì‚¬ ìš´í–‰ì„ ìœ„í•´ì„œ 
5. ê³µí•­ì— ë³´ì‰ì‚¬ ì •ë¹„ ìš”ì›ì„ ë” ë§ì´ ë°°ì¹˜í•˜ì—¬, ì˜ˆë°© ì •ë¹„ë¥¼ ì² ì§€íˆ í•˜ë„ë¡ í•´ì•¼í•œë‹¤. 
6. ì•„ë‹ˆë©´ ë°œìƒ ë¹ˆë„ë¥¼ ë°”íƒ•ìœ¼ë¡œ 3ê°œì˜ íšŒì‚¬ë³„ ë¹„ìš©ì„ ì‚°ì •í•˜ì—¬ ë°°ë¶„ë‹¤. 