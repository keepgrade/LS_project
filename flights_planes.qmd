---
title: "'nycflights13' ë³´ê³ ì„œ"
title-slide-attributes: 
  data-background-image: images/ua_dep.png
  data-background-size: cover
  data-background-opacity: "0.5"  # ë°°ê²½ íˆ¬ëª…ë„ ì¡°ì ˆ
  data-font-size: 48px  # ğŸ”¥ ê¸°ë³¸ ê¸€ì í¬ê¸° ì¡°ì ˆ (ì œëª©, ë¶€ì œëª©, ì €ì í¬í•¨)
author: "Team F5 : ì •ì˜ì£¼, í•œì§€ìˆ˜, ì‹ íƒœì„ "
subtitle: "UA í•­ê³µì˜ ì œì¡°ì‚¬ë³„ ì¶œë°œ ì§€ì—° ë¶„ì„"
format:
  revealjs:
    footer: "Â© 2025 Team F5"
    logo: "images/logo.png"
    slide-number: true
    theme: night  # ë‚´ì¥ í…Œë§ˆ ì ìš©
    html: 
      code-fold: true  # (ì„ íƒ) ì½”ë“œ ì ‘ê¸° ê¸°ëŠ¥ ì¶”ê°€
execute:
  echo: true  # ê¸°ë³¸ì ìœ¼ë¡œ ì½”ë“œì™€ ê²°ê³¼ ëª¨ë‘ í‘œì‹œ
  warning: false  # (ì„ íƒ) ê²½ê³  ë©”ì‹œì§€ ìˆ¨ê¸°ê¸°
css: styles.css  # ğŸ”¥ CSS íŒŒì¼ ì ìš©
---

```{python}
#| echo : false 
import pandas as pd
import numpy as np
import seaborn as sns
import matplotlib.pyplot as plt
from nycflights13 import flights, planes

```

## 1. ìš´í•­ ì§€ì—° ë¶„ì„ ë°°ê²½ {.text-center}

::: {.callout-note appearance="simple"}

### âœˆï¸ UA í•­ê³µì‚¬ í•­ê³µê¸° ì§€ì—° ë¶„ì„
- **ì–´ë–¤ ì œì¡°ì‚¬ì˜ í•­ê³µê¸°ê°€ ì§€ì—°ì„ ìì£¼ ìœ ë°œí•˜ëŠ”ê°€?**  
- **ìš´í•­ íš¨ìœ¨ì„±ì„ í–¥ìƒì‹œí‚¤ê¸° ìœ„í•œ ë°©ì•ˆì€ ë¬´ì—‡ì¸ê°€?**
:::

![](./images/catoon.png){width=800 height=400}


/ê°œì„ ì‚¬í•­/ ê°€ë¡œë¡œ ë‘ê°œ ë°°ì—´ í•˜ê¸° 

## 2.1 ë°ì´í„° ì •ë³´

::: {.column width="50%" style="margin-top:100px;"}
```{python}
flights.info()
```
:::
::: {.column width="50%" style="margin-top:100px;"}

```{python}
planes.info()
```
:::

## 2.2 ë°ì´í„° ì „ì²˜ë¦¬

- ë‘ ë°ì´í„°ë¥¼ tailnum ê¸°ì¤€ìœ¼ë¡œ ë³‘í•©í•˜ì—¬ ê¸°ì²´ë³„ ì œì¡°ì‚¬ ì •ë³´ë¥¼ ê²°í•©
```{python}
# tailnumì„ keyë¡œ merge í•˜ê¸° 
df = pd.merge(flights, planes, on = 'tailnum', how='left')
print("ë³‘í•©ëœ ë°ì´í„° :", len(df))
```

```{python}
#| echo : false 

# í•­ê³µì‚¬ë³„ ìš´í•­ í¸
flight = flights.groupby('carrier')['flight'].nunique().reset_index()
flight_sorted = flight.sort_values(by='flight', ascending=False)

# ì‹œê°í™”
plt.figure(figsize=(10, 2))
plt.bar(flight_sorted['carrier'], flight_sorted['flight'], color='skyblue')

plt.xlabel("Airline", fontsize=15, fontweight='bold')
plt.ylabel("Number of Flights", fontsize=15, fontweight='bold')
plt.title("Number of Flights by Airline", fontsize=20, fontweight='bold')
plt.xticks(rotation=45)
plt.show()
```

- UA í•­ê³µì‚¬(ìš°ë¦¬ íšŒì‚¬: ìš´í–‰ëŸ‰ 1ìœ„) ë°ì´í„°ë§Œ ê°€ì ¸ì˜¤ê¸°
```{python}
df  = df[df['carrier']=='UA']
df_len = len(df)
print("UA í•­ê³µì‚¬ì˜ ìš´í–‰ëŸ‰ :", df_len)
```

## 2.3 ë‚ ì§œ ë° ì‹œê°„ ë°ì´í„° ì¶”ê°€
- ì—°, ì›”, ì¼, ì‹œ, ë¶„ ë°ì´í„°ë¥¼ ì¡°í•©í•´ date_time ìƒì„±
```{python}
df['date_time'] = pd.to_datetime(df['year_x'].astype(str) + '-' + df['month'].astype(str) + '-' + df['day'].astype(str) + ' ' + df['hour'].astype(str) + ':' + df['minute'].astype(str))
```

- 2013ë…„ 1ì›”~6ì›”(ìƒë°˜ê¸°) ë°ì´í„°ë¥¼ í•„í„°ë§
```{python}
df_fh =df
#df_fh = df[(df['date_time'] >= '2013-01-01') & (df['date_time'] <= '2013-06-30')]
#first_half = len(df_fh)
#print("f {df_len}=>{fisrt_half}")
```

- ë¹ ë¥¸ ì´ë¥™ì€ ì§€ì—° ì›ì¸ì´ ì•„ë‹ˆë¯€ë¡œ 0ìœ¼ë¡œ ë³€ê²½
```{python}

#0ë³´ë‹¤ ì‘ìœ¼ë©´ 0ì´ë¼ê³  í•˜ê¸° 
df_fh['dep_delay'] = df_fh['dep_delay'].apply(lambda x: 0 if x < 0 else x)

zero_df_fh = len(df_fh)
# ë³€í™˜ í›„ ë°ì´í„° í¬ê¸° ì¶œë ¥
print(zero_df_fh)
```

## 2.4 ì´ìƒì¹˜ ì œê±°

- ì´ìƒì¹˜ ì œê±°ë¥¼ ìœ„í•œ IQR(Interquartile Range) ê³„ì‚°

```{python}
Q1 = df_fh['dep_delay'].quantile(0.25)
Q3 = df_fh['dep_delay'].quantile(0.75)
IQR = Q3 - Q1


lower_bound = Q1 - 1.5 * IQR
upper_bound = Q3 + 1.5 * IQR

df_fh = df_fh[(df_fh['dep_delay'] >= lower_bound) & (df_fh['dep_delay'] <= upper_bound)]
iqr_del_df = len(df_fh)

print(Q1, Q3)
print("f {zero_df_fh} => {iqr_del_df}")
```


// ì½”ë“œ ë„£ê¸°
// í…Œí¬ë‹‰ ì„¤ëª… ë¶€ë¶„ ë„£ê¸° 
// ex) ë°” ì°¨íŠ¸ ê·¸ë¦¬ê³ , ë¹ˆë„ ë„£ê³  ê²¹ì³ ì ¸ì„œ ê·¸ë ¸ë‹¤.
// subplotì„ ë„£ì—ˆë‹¤. 

// ë³´ì‰ë§Œ ë¹¨ê°„ìƒ‰ ë‚˜ë¨¸ì§€ëŠ” íšŒìƒ‰ ! 
// ë¯¼ ë¯¸ë””ì–¸ ë‚˜ëˆ„ê¸° 

// ë³´ì‰ë§Œ ë‹ë³´ì´ê²Œ ë§Œë“¤ê¸° 






## 3.2 ì œì¡°ì‚¬ë³„ í‰ê·  ë° ì¤‘ì•™ê°’ ì§€ì—° ì‹œê°„ ë¶„ì„  

::: {.callout-note appearance="simple"}
### â³ ì œì¡°ì‚¬ë³„ í‰ê·  ì§€ì—° ì‹œê°„ & ì¤‘ì•™ê°’ ì§€ì—° ì‹œê°„ ë¹„êµ  
- **íŠ¹ì • ì œì¡°ì‚¬ì˜ í•­ê³µê¸°ê°€ í‰ê· ì ìœ¼ë¡œ ë” ì˜¤ë«ë™ì•ˆ ì§€ì—°ë˜ëŠ”ê°€?**  
- **í‰ê· (Mean)ê³¼ ì¤‘ì•™ê°’(Median)ì„ ë¹„êµí•˜ì—¬ ì´ìƒì¹˜(outlier)ì˜ ì˜í–¥ì„ í™•ì¸**  
- **ë³´ì‰(Boeing) ì œì¡°ì‚¬ê°€ ê°•ì¡°ë˜ë„ë¡ ì •ë ¬**  
:::

::: {.cell}
```{python}
#| echo: false
#| fig-align: "center"

import matplotlib.pyplot as plt
import seaborn as sns

# 0ì„ ì œê±°í•œ ë°ì´í„° ì‚¬ìš©
df_fh_tmp = df_fh[df_fh['dep_delay'] > 0]

# ì œì¡°ì‚¬ë³„ í‰ê·  ë° ì¤‘ì•™ê°’ ê³„ì‚°
mean_delay = df_fh_tmp.groupby('manufacturer')['dep_delay'].mean()
median_delay = df_fh_tmp.groupby('manufacturer')['dep_delay'].median()

# ë³´ì‰(Boeing)ì„ ê°€ì¥ ë¨¼ì € ë‚˜ì˜¤ë„ë¡ ì •ë ¬
mean_delay = mean_delay.sort_values(ascending=False)  # ê¸°ë³¸ ì •ë ¬
median_delay = median_delay[mean_delay.index]  # ê°™ì€ ìˆœì„œë¡œ ì •ë ¬

if 'BOEING' in mean_delay.index:
    ordered_index = ['BOEING'] + [m for m in mean_delay.index if m != 'BOEING']
    mean_delay = mean_delay.reindex(ordered_index)
    median_delay = median_delay.reindex(ordered_index)

# ì‹œê°í™”
plt.figure(figsize=(8, 4))
bar_width = 0.4  # ë§‰ëŒ€ ë„ˆë¹„ ì„¤ì •
x = range(len(mean_delay))

plt.bar(x, mean_delay, width=bar_width, label="Mean Delay", color=sns.color_palette("pastel")[0])
plt.bar([i + bar_width for i in x], median_delay, width=bar_width, label="Median Delay", color=sns.color_palette("pastel")[2])

plt.xticks([i + bar_width / 2 for i in x], mean_delay.index, rotation=45)
plt.xlabel("Manufacturer", fontsize=12)
plt.ylabel("Departure Delay (minutes)", fontsize=12)
plt.title("Mean vs. Median Departure Delay by Manufacturer", fontsize=14)
plt.legend()
plt.grid(True)

plt.show()
```
:::



// ë³´ì‰ë§Œ ë¹¨ê°„ìƒ‰ ë‚˜ë¨¸ì§€ëŠ” íšŒìƒ‰ ! 
// ë¯¼ ë¯¸ë””ì–¸ ë‚˜ëˆ„ê¸° 

// ë³´ì‰ë§Œ ë‹ë³´ì´ê²Œ ë§Œë“¤ê¸° 

## 3.2  ì œì¡°ì‚¬ ë°ì´í„° ì²˜ë¦¬

::: {.callout-note appearance="simple"}
### UA í•­ê³µì‚¬ê°€ ìš´í–‰í•˜ëŠ” ë¹„í–‰ê¸°ì˜ ì œì¡°ì‚¬ì˜ ë¹„ìœ¨
:::

```{python}
#| echo: false
#| fig-align: "center"

manufacturer_counts = df_fh['manufacturer'].value_counts()

# ì œì¡°ì‚¬ ì´ë¦„ê³¼ ìš´í•­ íšŸìˆ˜ë¥¼ í•¨ê»˜ í‘œì‹œ
labels = [f"{manufacturer} ({count})" for manufacturer, count in zip(manufacturer_counts.index, manufacturer_counts.values)]

plt.figure(figsize=(5, 5))
plt.pie(manufacturer_counts, labels=labels, autopct='%1.1f%%', startangle=140, colors=sns.color_palette('pastel'))
plt.title('Aircraft Manufacturer Distribution for Our Airline')
plt.show()
```

## 3.3 ì œì¡°ì‚¬ë³„ ì§€ì—° ë°œìƒ ë¹ˆë„ ë¶„ì„  

::: {.callout-note appearance="simple"}
### ğŸš€ ì œì¡°ì‚¬ë³„ ì§€ì—° ë°œìƒ íšŸìˆ˜ ë° ë¹„ìœ¨  
- **ì–´ë–¤ ì œì¡°ì‚¬ì˜ í•­ê³µê¸°ê°€ ê°€ì¥ ë§ì´ ì§€ì—°ë˜ëŠ”ê°€?**  
- **ì „ì²´ ìš´í•­ ëŒ€ë¹„ ì§€ì—° ë¹„ìœ¨ì€ ì œì¡°ì‚¬ë³„ë¡œ ì°¨ì´ê°€ ìˆëŠ”ê°€?**  
:::

```{python}
#| echo: false
#| fig-align: "center"

import matplotlib.pyplot as plt
import seaborn as sns

# ì§€ì—° ë°œìƒ íšŸìˆ˜ ê³„ì‚° (dep_delay > 0 ì¸ ê²½ìš°ë§Œ)
delay_counts = df_fh[df_fh['dep_delay'] > 0].groupby('manufacturer')['dep_delay'].count()

# ì „ì²´ ìš´í•­ ëŒ€ë¹„ ì§€ì—° ë¹„ìœ¨ ê³„ì‚°
total_flights = df_fh['manufacturer'].value_counts()
delay_rate = (delay_counts / total_flights).fillna(0) * 100  # í¼ì„¼íŠ¸ ë³€í™˜

# ë°ì´í„° ì •ë ¬
delay_df = (
    pd.DataFrame({'Delay Count': delay_counts, 'Delay Rate (%)': delay_rate})
    .sort_values(by="Delay Count", ascending=False)
)

# ì‹œê°í™”
fig, ax1 = plt.subplots(figsize=(10, 3.7))

sns.barplot(x=delay_df.index, y=delay_df["Delay Count"], palette="pastel", ax=ax1)
ax1.set_ylabel("Number of Delays", fontsize=12)
ax1.set_xlabel("Manufacturer", fontsize=12)
ax1.set_title("Number of Delays by Manufacturer", fontsize=14)
ax1.tick_params(axis="x", rotation=45)

# ì§€ì—° ë¹„ìœ¨(%) ì¶”ê°€ (ë³´ì¡° ì¶•)
ax2 = ax1.twinx()
sns.lineplot(x=delay_df.index, y=delay_df["Delay Rate (%)"], marker="o", color="red", ax=ax2)
ax2.set_ylabel("Delay Rate (%)", fontsize=12)
ax2.grid(False)

plt.show()

```


# ê²°ë¡  ì •ë¦¬

1. ì œì¡°ì‚¬ë³„ í‰ê·  ì§€ì—° ì‹œê°„, ì¤‘ì•™ê°’ì€ ë¹„ìŠ·í•˜ë‹¤.
2. ìš°ë¦¬ í•­ê³µì‚¬ê°€ ìš´í–‰í•˜ëŠ” ë¹„í–‰ê¸°ì˜ ì œì¡°ì‚¬ ë¹„ìœ¨ì€ ë³´ì‰ì´ 72.2ë¡œ ì••ë„ì ì´ë‹¤. 
3. ë˜ ì œì¡°ì‚¬ë³„ ì§€ì—° ë°œìƒ ë¹ˆë„ë¥¼ ë¶„ì„í–ˆì„ ë•Œ ë³´ì‰ì‚¬ì˜ ë¹„í–‰ê¸°ê°€ 42%ë¡œ ê°€ì¥ ë†’ì€ ë¹„ìœ¨ì„ ë³´ì—¬ì¤€ë‹¤. 
4. ë”°ë¼ì„œ ìš°ë¦¬ëŠ” í•œì •ëœ ìì›ìœ¼ë¡œ íš¨ìœ¨ì ì¸ í•­ê³µì‚¬ ìš´í–‰ì„ ìœ„í•´ì„œ 
5. ê³µí•­ì— ë³´ì‰ì‚¬ ì •ë¹„ ìš”ì›ì„ ë” ë§ì´ ë°°ì¹˜í•˜ì—¬, ì˜ˆë°© ì •ë¹„ë¥¼ ì² ì§€íˆ í•˜ë„ë¡ í•´ì•¼í•œë‹¤. 
6. ì•„ë‹ˆë©´ ë°œìƒ ë¹ˆë„ë¥¼ ë°”íƒ•ìœ¼ë¡œ 3ê°œì˜ íšŒì‚¬ë³„ ë¹„ìš©ì„ ì‚°ì •í•˜ì—¬ ë°°ë¶„ë‹¤. 



















## 3.3 ì œì¡°ì‚¬ë³„ ì›”ë³„ ì§€ì—° íŒ¨í„´ ë¶„ì„  

::: {.callout-note appearance="simple"}
### ğŸ“… ì œì¡°ì‚¬ë³„ ì›”ë³„ í‰ê·  ì§€ì—° ì‹œê°„ ë¶„ì„  
- **ì œì¡°ì‚¬ë³„ë¡œ íŠ¹ì • ì›”ì— ë” ì§€ì—°ì´ ë§ì´ ë°œìƒí•˜ëŠ”ê°€?**  
- **ë‚ ì”¨(ê²¨ìš¸ í­ì„¤, ì—¬ë¦„ íƒœí’ ë“±)ê°€ ì˜í–¥ì„ ì£¼ëŠ”ì§€ ë¶„ì„ ê°€ëŠ¥**  
- **ë³´ì‰(Boeing) ì œì¡°ì‚¬ê°€ ê°•ì¡°ë˜ë„ë¡ ì •ë ¬ ë° ìŠ¤íƒ€ì¼ ì¡°ì •**  
:::

::: {.cell}
```{python}
#| echo: false
#| fig-align: "center"

import matplotlib.pyplot as plt
import seaborn as sns

# ì›”ë³„ ë°ì´í„° ìƒì„±
df_fh['month'] = df_fh['date_time'].dt.month

# ì œì¡°ì‚¬ë³„ ì›”ë³„ í‰ê·  ì§€ì—° ê³„ì‚°
monthly_delay = df_fh.groupby(['manufacturer', 'month'])['dep_delay'].mean().unstack()

# ë³´ì‰(Boeing)ì„ ë§¨ ì•ìœ¼ë¡œ ì •ë ¬
if 'BOEING' in monthly_delay.index:
    monthly_delay = monthly_delay.reindex(['BOEING'] + [m for m in monthly_delay.index if m != 'BOEING'])

# ì‹œê°í™”
plt.figure(figsize=(12, 4))
sns.lineplot(data=monthly_delay.T, marker="o")

plt.xlabel("Month", fontsize=12)
plt.ylabel("Average Delay (minutes)", fontsize=12)
plt.title("Monthly Average Delay by Manufacturer", fontsize=14)
plt.legend(title="Manufacturer")
plt.grid(True)

plt.show()
```
:::


## 3.4 ì œì¡°ì‚¬ë³„ ìš´í–‰ ëŒ€ìˆ˜ vs. í‰ê·  ì§€ì—° ì‹œê°„ vs. ì§€ì—° ë¹„ìœ¨ (3D ë¶„ì„)  

::: {.callout-note appearance="simple"}
### ğŸ“Š ì œì¡°ì‚¬ë³„ ìš´í–‰ ëŒ€ìˆ˜, í‰ê·  ì§€ì—° ì‹œê°„, ì§€ì—° ë¹„ìœ¨ 3D ì‹œê°í™”  
- **ìš´í•­ ëŒ€ìˆ˜ê°€ ë§ì„ìˆ˜ë¡ ì§€ì—°ì´ ë§ì•„ì§€ëŠ”ê°€?**  
- **íŠ¹ì • ì œì¡°ì‚¬ê°€ ë” íš¨ìœ¨ì ìœ¼ë¡œ ìš´í•­í•˜ëŠ”ê°€?**  
:::

::: {.cell}
```{python}
#| echo: false
#| fig-align: "center"

from mpl_toolkits.mplot3d import Axes3D
import matplotlib.pyplot as plt
import numpy as np
import seaborn as sns

# ì œì¡°ì‚¬ë³„ ìš´í•­ ëŒ€ìˆ˜, í‰ê·  ì§€ì—° ì‹œê°„, ì§€ì—° ë¹„ìœ¨ ê³„ì‚°
manufacturer_flight_counts = df_fh['manufacturer'].value_counts()
mean_dep_delay = df_fh[df_fh['dep_delay'] > 0].groupby('manufacturer')['dep_delay'].mean()
delay_rate = (df_fh[df_fh['dep_delay'] > 0].groupby('manufacturer')['dep_delay'].count() / manufacturer_flight_counts) * 100

# ë³´ì‰(Boeing)ì„ ë§¨ ì•ìœ¼ë¡œ ì •ë ¬
if 'BOEING' in manufacturer_flight_counts.index:
    manufacturer_flight_counts = manufacturer_flight_counts.reindex(['BOEING'] + [m for m in manufacturer_flight_counts.index if m != 'BOEING'])
    mean_dep_delay = mean_dep_delay.reindex(manufacturer_flight_counts.index)
    delay_rate = delay_rate.reindex(manufacturer_flight_counts.index)

# 3D ì‹œê°í™” ì„¤ì •
fig = plt.figure(figsize=(20, 4))
ax = fig.add_subplot(111, projection='3d')

x_labels = manufacturer_flight_counts.index
x = np.arange(len(x_labels))
y = manufacturer_flight_counts.values
z = np.zeros(len(x))  # ë§‰ëŒ€ê·¸ë˜í”„ ì‹œì‘ì  (0ì—ì„œ ì‹œì‘)

dx = np.ones(len(x)) * 0.5  # ë§‰ëŒ€ ë‘ê»˜
dy = np.ones(len(x)) * 0.5  # ë§‰ëŒ€ ê¹Šì´
dz = mean_dep_delay.loc[x_labels].values  # í‰ê·  ì§€ì—° ì‹œê°„ (ë§‰ëŒ€ ë†’ì´)

# ìƒ‰ìƒ ì§€ì • (seaborn pastel íŒ”ë ˆíŠ¸ ì‚¬ìš©)
colors = sns.color_palette("pastel", len(x))

# 3D ë°” ì°¨íŠ¸ ìƒì„± (ì…ì²´ê° ì¶”ê°€)
ax.bar3d(x, y, z, dx, dy, dz, color=colors, shade=True)

# ì¶• ì„¤ì • ë° ì œëª©
ax.set_xlabel("Manufacturer", fontsize=10, labelpad=10)
ax.set_ylabel("Total Flights Operated", fontsize=10, labelpad=10)
ax.set_zlabel("Mean Delay (minutes)", fontsize=10, labelpad=10)
ax.set_xticks(x)
ax.set_xticklabels(x_labels, rotation=45)

plt.show()
```
:::



## 4. 